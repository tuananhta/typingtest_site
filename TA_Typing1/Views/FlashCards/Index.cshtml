@model IEnumerable<TA_Typing1.Models.FlashCard>

@{
    ViewBag.Title = "flashCards";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="container text-center">
    <h2>Flash Cards</h2>
</div>
<div class="container navbar navbar-default navbar-fixed-top header-fixed" id="header1-flash-cards" style="display:none;">
    <div class="col-xs-12 text-center">
        <span id="paint-card-btm" class="btn btn-default disabled" style="font-size:20px;margin-right:70px; padding-right:40px; padding-left:40px;">Paint cards</span>
        <span id="submit-color-option">
            <span class="btn btn-default refresh-btn margin-btn" onclick="submitColorOptions()">Save</span>
            <span class="btn btn-danger margin-btn" onclick="location.reload()">Cancel</span>
        </span>
    </div>
</div>
<div class="container navbar navbar-default navbar-fixed-top header-fixed" id="header2-flash-cards" style="display:none;">
    <div class="col-xs-12 text-center">
        <span id="favourite-card-btm" class="btn btn-default disabled" style="font-size:20px;margin-right:70px; padding-right:40px; padding-left:40px;">Choose favourite cards</span>
        <span id="submit-favourite-option">
            <span class="btn btn-default refresh-btn margin-btn" onclick="submitColorOptions()">Save</span>
            <span class="btn btn-danger margin-btn" onclick="location.reload()">Cancel</span>
        </span>
    </div>
</div>
<br />
<hr style="margin:0; padding:0;" />
<div class="container background1">
    <div class="col-md-9 col-md-push-3">
        <div id="stats_form" class="container" style="height:283px;">
            @{ Html.RenderAction("statistic", "flashcards", new { dateOfWeek = DateTime.Today }); }
        </div>
        <form id="searchForm" style="display:none; margin-bottom:auto; margin-top:auto;">
            <div class="panel panel-default bootcards-chart">
                <div class="panel-heading text-center">
                    <h3 class="panel-title">Search words by date, weeks</h3>
                </div>
                <table id="search-card-tab" class="form-inline text-center col-xs-12" style="margin-top:30px; margin-bottom:auto;">
                    <tr>
                        <td>
                            <div class="container" style="margin:10px;">
                                <div class="col-sm-5 margin-top-bottom"><h3 style="margin:0;">By date</h3></div>
                                <div class="col-sm-7 text-left margin-top-bottom">

                                    <span class="input-group date_picker" style="max-width: 400px;margin: 0;margin-left: auto; margin-right: auto;">
                                        <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                                        <input id="date_query" name="date_query" autocomplete="off" class="form-control date_picker" placeholder="dd/mm/yyyy" style="min-width:300px; max-width:95%; padding-left:8%; padding-right:8%" type="text" value="@ViewBag.date_query">
                                        <span class=" btn input-group-addon refresh-btn" onclick="{ $('#week_query').val(''); $('#searchForm').submit() }"><span class="glyphicon glyphicon-search"></span> Search</span>
                                    </span>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="container" style="margin:10px;">
                                <div class="col-sm-5 margin-top-bottom"><h3 style="margin:0;">By weeks</h3></div>
                                <div class="col-sm-7 text-left margin-top-bottom">
                                    <span class="input-group" style="max-width: 400px;margin: 0;margin-left: auto; margin-right: auto;">
                                        <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                                        <input id="week_query" name="week_query" autocomplete="off" class="form-control" placeholder="Recent weeks" style="min-width:300px; max-width:95%; padding-left:8%; padding-right:8%" type="number" value="@ViewBag.week_query">
                                        <span class=" btn input-group-addon refresh-btn" onclick="{ $('#date_query').val(''); $('#searchForm').submit() }"><span class="glyphicon glyphicon-search"></span> Search</span>
                                    </span>
                                </div>

                            </div>
                        </td>
                    </tr>
                </table>
            </div>
            <input id="fav_list" name="fav_list" hidden value="@ViewBag.fav_list" />
        </form>
    </div>

    <div id="menu_option_flashcard" class="col-md-3 col-md-pull-9">
        <div class="col-xs-12" aria-label="...">
            <div style="margin-left:0px; border-radius:0;" id="paint-card-btm" class="col-xs-12 btn btn-default margin-btn container active" onclick="{ $('#searchForm').hide(); $('#stats_form').fadeIn('fast'); }">
                <span class="glyphicon glyphicon-stats col-xs-1"></span>
                <span class="col-xs-7 text-left" style="padding-left:3px;"> Words statistic</span>
            </div>
            <div style="border-top: none; margin-left:0px; border-radius:0;" id="paint-card-btm" class="col-xs-12 btn btn-default margin-btn container" onclick="{ $('#stats_form').hide(); $('#searchForm').fadeIn('fast'); }">
                <span class="glyphicon glyphicon-filter col-xs-1"></span>
                <span class="col-xs-7 text-left" style="padding-left:3px;"> Sort by date, weeks</span>
            </div>
            <div style="border-top: none; margin-left:0px; border-radius:0;" id="paint-card-btm" class="col-xs-12 btn btn-default margin-btn container" onclick="showColorOption()">
                <span class="glyphicon glyphicon-tint col-xs-1"></span>
                <span class="col-xs-7 text-left" style="padding-left:3px;"> Paint your cards</span>
            </div>
            <div style="margin-left:0px; border-radius:0; border-top:none;" id="favourite-card-btm" class="col-xs-12 btn btn-default margin-btn container" onclick="showFavouriteOption()">
                <span class="glyphicon glyphicon-heart col-xs-1"></span>
                <span class="col-xs-7 text-left" style="padding-left:3px;"> Choose favourite cards</span>
            </div>
            <div class="col-xs-12 btn btn-default container" style="margin-left:0px; border-radius:0; border-top:none;" onclick="{ $('#fav_list').val('false'); $('#searchForm').submit(); }">
                <span class="glyphicon glyphicon-share-alt col-xs-1"></span>
                <span class="col-xs-7 text-left" style="padding-left:3px;"> Show all cards</span>
            </div>
            <div class="col-xs-12 btn btn-default container" style="margin-left:0px; border-radius:0; border-top:none;" onclick="{ $('#fav_list').val('true'); $('#searchForm').submit(); }">
                <span class="glyphicon glyphicon-star-empty col-xs-1"></span>
                <span class="col-xs-7 text-left" style="padding-left:3px;"> Show favourite cards</span>
            </div>

            <div style="margin-left: 0px; border-radius: 0; border-top: none;" class="col-xs-12 btn btn-default dropdown-toggle container" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
                <span class="glyphicon glyphicon-menu-down col-xs-1"></span>
                <span class="col-xs-7 text-left" style="padding-left:3px;"> More options</span>
            </div>
            <ul class="col-xs-12 dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                <li role="presentation"><a style="padding-bottom:10px; padding-top:10px" role="menuitem" tabindex="-1" id="rand-position-btn" onclick="{ searchForm.submit(); }"><span class="glyphicon glyphicon-backward" style="padding-right:4px;"></span> Original position</a></li>
                <li role="presentation"><a style="padding-bottom:10px; padding-top:10px" role="menuitem" tabindex="-1" id="rand-position-btn" onclick="randomPosition()"><span class="glyphicon glyphicon-random" style="padding-right:4px;"></span> Shuffle cards</a></li>
                <li role="presentation"><a style="padding-bottom:10px; padding-top:10px" role="menuitem" tabindex="-1" id="rand-position-btn" onclick="rotateAll()"><span class="glyphicon glyphicon-refresh" style="padding-right:4px;"></span> Rotate cards</a></li>
            </ul>
        </div>
    </div>
</div>
<hr style="padding:0;margin:0;" />
<br />
<br />
<div role="tabpanel" class="tab-pane fade in active" id="tab-words" style="background-color:#3a7147">
    <div id="grid-containter" class="center-block container text-center" style="border-radius:5px;border:15px ridge #808080">
        <h2 style="color:#ffffff; text-decoration:underline">@ViewBag.fav_title</h2>
        <h3 style="color:whitesmoke">@ViewBag.boardInfo</h3>
        <hr style="background-image:url(../../Images/Background/chalkboard_top.png); height:10px;" />
        <div id="loading_tab" class="text-center">
            <div class="container text-center">
                <h2 style="margin-top:30px; margin-bottom:30px;"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> Loading</h2>
            </div>
        </div>
        <form style="display:none;" id="grid-container-form" class="form-color-option" method="post" action="@Url.Action("edit", "flashcards")">
            @Html.AntiForgeryToken()
            @{
                int modelCount = 0;
                foreach (var item in Model)
                {
                    <section id="grid-@modelCount" class="card-grid" style="display:none;">
                        <div id="front-@item.id" class="front @item.fColor-front">
                            <div class="container text-right" style="margin:5px;">
                                <span class="color-opt">
                                    <span class="btn btn-flash btn-flash-default" onclick="updateColor(event, @item.id, 'default')">
                                    </span>
                                    <span class="btn btn-flash btn-flash-pink" onclick="updateColor(event, @item.id, 'pink')">
                                    </span>
                                    <span class="btn btn-flash btn-flash-green" onclick="updateColor(event, @item.id, 'green')">
                                    </span>
                                    <span class="btn btn-flash btn-flash-blue" onclick="updateColor(event, @item.id, 'blue')">
                                    </span>
                                    <span class="inputGroup" hidden="hidden">
                                        <input class="fColor-input" name="cards[@modelCount].fColor" value="@item.fColor" />
                                        <input class="fFavourite-input" name="cards[@modelCount].fFavourite" value="@item.fFavourite.ToString()" />
                                        <input name="cards[@modelCount].CreatedTime" value="@item.createdTime" />
                                        <input name="cards[@modelCount].id" value="@item.id" />
                                    </span>
                                </span>
                                <span class="favourite-opt" style="display:none;">
                                    @if (item.fFavourite == false)
                                    {
                                        <span class="false_favourite" style="position:static;" onclick="addFavourite(event,@item.id)"><span class="btn btn-xs refresh-btn"><span style="position:static;" class="glyphicon glyphicon-plus-sign"></span> Add to favourite</span></span>
                                        <span class="true_favourite" style="position:static; display:none" onclick="removeFavourite(event, @item.id)"><span class="btn btn-default btn-xs"><span style="position:static;" class="glyphicon glyphicon-remove"></span> Remove favourite</span> <img style="height:30px;" src="~/Images/Icon/fav_true.png" /></span>
                                    }
                                    else
                                    {
                                        <span class="false_favourite" style="position:static; display:none;" onclick="addFavourite(event,@item.id)"><span class="btn btn-xs refresh-btn"><span style="position:static;" class="glyphicon glyphicon-plus-sign"></span> Add to favourite</span></span>
                                        <span class="true_favourite" style="position:static; " onclick="removeFavourite(event, @item.id)"><span class="btn btn-default btn-xs"><span style="position:static;" class="glyphicon glyphicon-remove"></span> Remove favourite</span> <img style="height:30px;" src="~/Images/Icon/fav_true.png" /></span>
                                    }
                                </span>
                                <span style="position:static"><img style="height:20px;" src="~/Images/Icon/pin.png" /></span>
                            </div>

                            <h2 class="text-primary" style="margin-top:7px;">@item.word.WordDetail.WContext</h2>
                            @{
                                    string wordTypes = null;

                                    foreach (var wType in item.word.WordDefs.GroupBy(m => m.wType))
                                    {
                                        wordTypes += wType.First(m => m.wType != null).wType + " ,";
                                    }


                                    if (wordTypes != null)
                                    {
                                        wordTypes = wordTypes.Remove(wordTypes.Length - 1);
                                        wordTypes = '(' + wordTypes + ')';
                                    }
                            }
                            <h4 class="text-danger"><i>@wordTypes</i></h4>

                            @if (item.word.WordDetail.WPronounce != null)
                            {
                                <h3 style="margin:0">/@item.word.WordDetail.WPronounce/</h3>
                            }

                        </div>
                        <div id="back-@item.id" class="back @item.fColor-back" style="overflow:scroll; overflow-x:hidden; overflow-y:auto;">
                            <div class="left container">
                                @{
                            int count = 0;
                            foreach (var def in item.word.WordDefs)
                            {
                                count++;
                                <div class="small">
                                    <span class="col-xs-1">@count.</span>
                                    <span class="col-xs-2">(@def.wType)</span>
                                    <span class="col-xs-9 text-danger"><b>@def.wDefinition</b></span>
                                    <span class="col-xs-11 col-xs-offset-1 text-left"><i class="text-primary">Eg: @def.wExample</i></span>
                                </div>

                            }
                                }
                            </div>
                        </div>
                    </section>
                            modelCount++;
                }
            }
        </form>
    </div>
</div>



<input id="total_grids" value="@modelCount" hidden="hidden" />
@section flashcardScript {
    <script>
        $(window).load(function () {
            $('#loading_tab').fadeOut('fast');
            $('#grid-container-form').delay(200).fadeIn('slow');
        });

        function handle_stat_form() {
            event.preventDefault();
            var data_loading = '<div class="container text-center"><br><h4 class="text-danger"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> Loading data ...</h4><div>'
            $.ajax({
                url: "@Url.Action("statistic", "flashcards")/?dateOfWeek=" + $('#stat_form_sbm').find('input').val(),
                type: "POST",
                beforeSend: function () {
                    $("#barChart").empty().append(data_loading);
                },
                success: function (data) {
                    $("#stats_form").empty().append(data);
                },
            });
        }

        $('#menu_option_flashcard').children().find("div").click(function () {
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });
    </script>
}